import{r as l,j as s,M as O}from"./i8w88cc8b3gds516.js";import{fO as R,ac as w,r as F,l as B,b8 as H,P as E,j as v,an as f,bn as K}from"./eh26o1l35t2fnjj4.js";import{p as L,al as k,am as U,an as W,ao as $}from"./jg63sxiyqeyvfv9f.js";import{T as X,a as y}from"./h5ki4u1sjcr6cdl0.js";import"./e7ldcb1pybd2xac9.js";const Q=/\*\*(.*?)(?:\*\*|\n|$)/g,C=a=>{let e=null,n;for(;(n=Q.exec(a))!=null;)e=n[1].trim();return e},V={strong:a=>{const{node:e,children:n,...t}=a;return s.jsx("strong",{...t,className:f(t.className,"font-semibold text-token-text-primary"),children:n})},p:a=>{const{node:e,children:n,...t}=a;return s.jsx("p",{...t,className:f(t.className,"text-base","has-[strong]:mb-1 [&:not(:first-child)]:has-[strong]:mt-3 [&:not(:has(strong))]:mb-3"),children:n})}};function Y({message:a,isExpandable:e}){const t=a.create_time?new Date(a.create_time*1e3):Date.now(),r=W(+t,48e4);return s.jsx($,{percentage:r,className:f("mr-4",e?"!w-3/4":"!w-full"),backgroundClassName:"bg-token-sidebar-surface-secondary rounded-full",barClassName:"bg-token-text-primary rounded-full",transitionDuration:`${(100-r)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)",height:8})}function q({isExpandable:a,handleOpenSidebarSummarizer:e,summarizationHeadline:n,latestTitle:t,message:r}){return s.jsx("div",{className:"pb-2",children:s.jsx(k,{buttons:[s.jsx(K,{onClick:e,color:"secondary",className:"!h-[38px] text-[15px] font-normal text-token-text-secondary",children:s.jsx("div",{className:"px-1",children:s.jsx(O,{id:"wQcuK8",defaultMessage:"Details"})})},"Details")],title:n,time:null,icon:s.jsx("div",{className:""}),content:`${t}...`,size:"small",progressBar:s.jsx(Y,{message:r,isExpandable:a})})})}function G({handleOpenSidebarSummarizer:a,summarizationHeadline:e,message:n}){return s.jsx("div",{className:"pb-2",children:s.jsx(k,{buttons:[],title:e,time:null,content:n.metadata?.finished_text??"",size:"small",disabled:!0,onClick:a})})}function T({completionInProgress:a,latestTitle:e,message:n,summaryText:t,isExpandable:r,disableExpansion:u,onOpenAnalytics:c,handleOpenSidebarSummarizer:m}){let i;return a?i=e:i=C(n.metadata?.finished_text??"")??n.metadata?.finished_text??"",s.jsx(X,{status:a?y.Running:y.Finished,highlightedCommand:i,onOpenAnalytics:c,onClick:m,children:t&&r&&!u?s.jsx("div",{className:"mb-4 border-l-2 pl-4 dark:border-token-text-secondary",children:s.jsx(U,{componentOverrides:V,className:"not-prose leading-6",children:t})}):null})}function ae({messages:a,isStreaming:e,isLastMessage:n,clientThreadId:t,currentGroupedMessageIndex:r,turnIndex:u}){const[c,m]=l.useState(""),[i,P]=l.useState(!1),b=R(t)===w.STREAMING,p=b||e,o=a[0].message,j=o.id,M=F.getServerThreadId(t),d=B(o),g=o.metadata?.summarization_headline,z=e&&g!=null,{toggleThreadSidebar:S}=H(),A=o.metadata?.model_slug?.startsWith("o1")&&o.metadata?.model_slug?.endsWith("o"),D=L(),x=l.useCallback(()=>{S({type:"summarizer",clientThreadId:t,currentGroupedMessageIndex:r,turnIndex:u})},[S,t,r,u]);l.useEffect(()=>{let _=C(d);_?m(_):o.metadata?.initial_text!=null&&m(o.metadata.initial_text)},[d,o.metadata?.initial_text]),l.useEffect(()=>{d.length>0&&P(!0)},[d]);const h=l.useMemo(()=>({client_thread_id:t,message_id:j,conversationId:M}),[t,j,M]);l.useEffect(()=>{i&&E.logEvent(v.receivedA8KM123Message,h)},[i]);const N=l.useCallback(()=>{E.logEvent(v.openedA8KM123Message,{...h,isStreaming:e})},[h,e]);return D?A?b&&n||e?s.jsx(q,{isExpandable:i,handleOpenSidebarSummarizer:x,summarizationHeadline:g??null,latestTitle:c,message:o}):s.jsx(G,{handleOpenSidebarSummarizer:x,summarizationHeadline:g??null,message:o}):s.jsx(T,{completionInProgress:p,latestTitle:c,message:o,onOpenAnalytics:N,handleOpenSidebarSummarizer:i||!e?x:void 0}):s.jsx(T,{completionInProgress:p,latestTitle:c,message:o,onOpenAnalytics:N,summaryText:d,isExpandable:i,disableExpansion:z})}export{V as SUMMARY_MARKDOWN_COMPONENT_OVERRIDES,ae as default};
//# sourceMappingURL=obl0r3ppfp7a769l.js.map
