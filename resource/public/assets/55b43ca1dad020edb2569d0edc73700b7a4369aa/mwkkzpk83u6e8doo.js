const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jwnh8v83a7u1jn9w.js","assets/i8w88cc8b3gds516.js","assets/eh26o1l35t2fnjj4.js","assets/root-inht5vcp.css","assets/nnwhse580ps19ifv.js","assets/diz3gorkdm8k36uy.js","assets/jg63sxiyqeyvfv9f.js","assets/conversation-small-nranh1cg.css","assets/dyuarriie396ezxd.js","assets/53nax822pkd7iwth.js","assets/ft5z2r2wosrho43b.js","assets/g56z0xf7aensi5ys.js","assets/ktx1rwus81sbm9r6.js","assets/bb879dawx0xebm64.js","assets/llwp8h6qvrwx9cn5.js"])))=>i.map(i=>d[i]);
import{j as e,c as O,r as o,a as B,ac as A,ad as pe,e as Se,L as be,M as H}from"./i8w88cc8b3gds516.js";import{aM as U,aN as W,eA as Z,a5 as P,y as $,b9 as G,f as J,g_ as ve,dm as X,e6 as je,an as C,eb as Ie,aT as Ce,bD as ye,bt as ke,ae as Ne,ei as Le,dn as Oe,df as Me,aW as ee,g$ as I,Q as Ee,U as Te,g5 as ze,c3 as se}from"./eh26o1l35t2fnjj4.js";import{hl as Fe,k8 as R,cj as _e,k9 as te,iR as Ae,gz as Ge,iJ as Pe,g8 as we,ka as z,hn as ne,kb as ae,_ as De,dd as ie,kc as T,f3 as Re,kd as He,ke as Be,f9 as Ue,a1 as re,kf as We,bE as Q,kg as oe,gA as V,u as Ve,kh as Ke,ki as ce,kj as qe,kk as Qe,kl as Ye,fW as Ze,fU as le,km as $e,fs as Je,U as de,fV as Xe,f4 as es,kn as ss,d0 as ts,d1 as ns,cY as as,as as is,ar as rs,ko as os,kp as _,ci as cs,M as ue,$ as ls,d3 as me,kq as ds,kr as us,ks as fe,hK as ms,kt as fs,ku as hs,kv as xs,eK as gs,gx as ps,bf as he,eL as Ss,cX as bs,O as j,kw as vs,J as js,kx as Is,ky as Cs,L as ys,cf as ks,kz as Ns,P as Ls,cL as Os}from"./jg63sxiyqeyvfv9f.js";import{u as w,c as Ms}from"./dyuarriie396ezxd.js";import{U as Es,P as Ts}from"./53nax822pkd7iwth.js";import{C as zs}from"./ft5z2r2wosrho43b.js";const Fs=U(()=>W(()=>import("./jwnh8v83a7u1jn9w.js"),__vite__mapDeps([0,1,2,3,4])).then(s=>s.SnorlaxFolderAnimation),{loading:({color:s})=>e.jsx(xe,{color:s})}),_s={open:{opacity:1,y:0,transition:{duration:.15,ease:"easeOut"}},closed:{opacity:0,y:-5,transition:{duration:.15,ease:"easeIn"}}};function As({color:s,folderState:t,gizmoId:a,sidebarSnorlaxFolderStore:i}){const n=O(),[l,c]=o.useState(!1);return e.jsx(G,{side:"top",sideOffset:4,delayDuration:600,label:t==="open"?n.formatMessage(Q.hideChatsForProjectTooltip):n.formatMessage(Q.showChatsForProjectTooltip),children:e.jsx("button",{onClick:d=>{d.preventDefault(),t==="open"?i.collapseProject(a):i.expandProject(a)},className:"-m-0.5 flex rounded-xl p-0.5 text-token-text-secondary hover:bg-token-sidebar-surface-tertiary",onMouseEnter:()=>{c(!0)},onMouseLeave:()=>{c(!1)},children:e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"relative flex h-full items-center justify-center text-token-text-primary",children:e.jsx(Fs,{isOpen:t==="open",isHovered:l,color:s})})})})})}function xe({color:s}){return e.jsx("div",{className:"flex h-6 w-6 shrink-0 items-center justify-center text-token-text-primary",children:e.jsx(Fe,{className:"h-3/4 w-3/4",style:{color:s}})})}function Gs({gizmo:s,historyDisabled:t,section:a,onClick:i,isActive:n,hideOverflowMenu:l=!1,elementRef:c}){const{clientThreadId:d}=w(),m=Z(d),r=O(),[u,g]=o.useState(!1),[f,x]=o.useState(!1),p=s.gizmo.id,S=R.useStore(),h=R.useState(k=>R.selectFolderState(k,p)),v=P(),N=!!s.gizmo.tags?.includes(_e.FirstParty),y=$(),M=B(),b=te(),{items:E=[],hasNextPage:ge}=Ae(s.gizmo.id),L=Ge(p),K=Pe(p,s.gizmo.display.theme);let D=!1;n&&L&&!(h==="open"&&m)&&(D=!0),o.useEffect(()=>{h!=="open"&&n&&m&&S.expandProject(p)},[n,m,S,p]);let F;if(s!=null)F=s.gizmo.display.name||we;else{if(v==null)return null;t?F=r.formatMessage(z.clearChat):F=oe}const q=b!=null&&b.kind==="conversation"&&(b.gizmoId==null||b.gizmoId!=p);return e.jsxs(e.Fragment,{children:[e.jsx(A.div,{onMouseEnter:()=>{x(!0)},onMouseLeave:()=>{x(!1)},onDrop:k=>{k.preventDefault(),q&&(ne(y,r,M,b.conversationId,p,b.gizmoId),x(!1))},onDragOver:k=>{k.preventDefault(),q&&x(!0)},onDragLeave:()=>{x(!1)},children:e.jsx(ae,{loggingGizmoId:s?.gizmo.id??"primary",href:De(s),onClick:i,showActiveIndicator:D,isHovered:f,icon:L&&E.length>0?e.jsx(As,{color:K,folderState:h,gizmoId:p,sidebarSnorlaxFolderStore:S}):L?e.jsx(xe,{color:K}):e.jsx(ie,{isFirstParty:N,src:s?.gizmo.display.profile_picture_url,className:"h-6 w-6 shrink-0"}),isMenuOpen:u,label:F,rightIcon:a===T.Workspace&&e.jsx(G,{side:"right",label:r.formatMessage(Y.workspaceRecommended,{workspace_name:v?.name??"Your Workspace"}),children:e.jsx(Re,{className:"icon-md text-token-text-secondary",alt:r.formatMessage(Y.workspaceRecommended,{workspace_name:v?.name??"Your Workspace"})})}),hoverRightIcon:e.jsxs("div",{className:"flex gap-2",children:[(f||u)&&!l&&(L?e.jsx("div",{className:"text-token-text-tertiary",onClick:k=>{k.preventDefault()},children:e.jsx(He,{gizmo:s,isOpen:u,setIsOpen:g})}):e.jsx("div",{className:"text-token-text-tertiary",onClick:k=>{k.preventDefault()},children:e.jsx(Be,{gizmo:s,isOpen:u,setIsOpen:g,section:a})})),!L&&!l&&e.jsx(G,{side:"right",label:r.formatMessage(t?z.clearChat:z.newChat),className:"flex items-center",children:e.jsx("button",{className:u?"text-token-text-tertiary":"invisible text-token-text-secondary hover:text-token-text-primary group-hover:visible",children:t?e.jsx(Ue,{className:"icon-md"}):e.jsx(re,{className:"icon-md"})})})]}),elementRef:c})}),e.jsx(pe,{initial:!1,children:L&&h==="open"&&E.length>0&&e.jsx(A.div,{initial:"closed",animate:"open",exit:"closed",variants:_s,className:"overflow-hidden",children:e.jsx(We,{gizmoResource:s,serverThreadId:m,isOnProjectPage:D,conversations:E,hasNextPage:ge})},"nested-conversations")})]})}const Y=J({workspaceRecommended:{id:"gizmo.workspaceRecommended",defaultMessage:"Recommended at {workspace_name}"}});function rt(s){const{className:t}=s,{useStore:a,actions:i}=V(),{focusedObject:n}=w(),c=!Ve()&&!!n,d=a(x=>x.isSidebarOpen)&&!c,m=a(x=>x.mode),r=ve(),u=X(),g=je(),f=Ke();return o.useEffect(()=>{u?i.closeSidebar():i.setSidebarMode(ce.Pinned)},[u,i]),e.jsx(qe,{...s,isSidebarOpen:d,isExtendedInfoOpen:g,isCanvasOpen:f,sidebarMode:m,className:C(t,r?"screen-loaded":"")})}function Ps(s){const{clientThreadId:t}=w(),a=o.useRef(s);a.current=s;const i=o.useRef(null);o.useEffect(()=>{const n=i.current;return i.current=t,()=>{t!==n&&a.current?.(t,n)}},[t])}function ws({isNewConversation:s}){const t=Qe();return e.jsxs(e.Fragment,{children:[e.jsx(Ds,{isNewConversation:s}),t?e.jsx(Ye,{}):null]})}const Ds=({isNewConversation:s})=>{const[t,a]=o.useState(!1),i=Ie(),n=B(),l=Se(),c=O(),d=P();let m;return d==null?null:(m=oe,e.jsx("div",{className:C(i?"":"bg-token-sidebar-surface-primary","pt-0"),children:e.jsx(e.Fragment,{children:e.jsx(A.div,{whileTap:{scale:.98},onMouseEnter:()=>{a(!0)},onMouseLeave:()=>{a(!1)},children:e.jsx(ae,{loggingGizmoId:"primary",href:"/",isHovered:t,onClick:r=>{Ce(ye(n))&&!s&&(r.preventDefault(),Ze(l))},icon:e.jsx(ie,{isFirstParty:!0,className:"h-6 w-6"}),isMenuOpen:!1,label:m,hoverRightIcon:e.jsx("div",{className:"flex gap-2",children:e.jsx(G,{side:"right",label:c.formatMessage(z.newChat),className:"flex items-center",children:e.jsx("button",{className:"invisible text-token-text-secondary hover:text-token-text-primary group-hover:visible","aria-label":c.formatMessage(z.newChat),children:e.jsx(re,{className:"icon-md"})})})})})})})}))};function Rs(){const s=O(),t=le(),a=s.formatMessage({id:"gizmo.exploreStoreEnabled",defaultMessage:"Explore GPTs"});return e.jsx($e,{children:e.jsx(A.div,{whileTap:{scale:.98},children:e.jsx(be,{to:Je(),onClick:()=>{t.activeSidebar==="popover-nav"&&de.setActiveSidebar(!1)},children:e.jsx(Xe,{icon:es,"data-testid":"explore-gpts-button",children:a})},"explore")})})}const Hs=2;function Bs({gizmos:s,maxToShowOnLoad:t=4,showAllSidebarItems:a}){const i=os(s,f=>f.flair.kind),n=[...(i[_.Workspace]?.map(({resource:f})=>({gizmo:f,section:T.Workspace}))??[]).slice(0,3),...i[_.FirstParty]?.map(({resource:f})=>({gizmo:f,section:T.Keep}))??[],...i[_.SidebarKeep]?.map(({resource:f})=>({gizmo:f,section:T.Keep}))??[]],l=i[_.Recent]??[],d=(a?l:l.slice(0,Hs)).map(({resource:f})=>({gizmo:f,section:T.Recents})),m=n.length;let r=[];r=[...n,...d],a||(r.length>t&&m>t?r=r.slice(0,m):r.length>t&&(r=r.slice(0,t)));const g=s.length>r.length;return{listItems:r,itemsLeft:s.length-r.length,needsToCollapseItems:g,total:s.length}}function Us({gizmo:s,currentGizmoId:t,maxToShowOnLoad:a,hideOverflowMenu:i=!1}){const n=o.useRef(!1),l=le(u=>!ss.isGptListCollapsed(u)),{listItems:c,needsToCollapseItems:d,itemsLeft:m}=Bs({gizmos:s,maxToShowOnLoad:a,showAllSidebarItems:l});o.useEffect(()=>{c.length>0&&!n.current&&(ts({namespace:ns.ChatPageLoad})?.logTiming("render_gizmo_sidebar"),n.current=!0)},[c]);function r(u,g){return e.jsx(Gs,{gizmo:u,isActive:u.gizmo.id===t,section:g,hideOverflowMenu:i},u.gizmo.id)}return e.jsxs("div",{children:[c.map(({gizmo:u,section:g},f)=>e.jsxs(o.Fragment,{children:[f>1&&g!==c[f-1].section&&e.jsx("div",{className:"my-2 ml-2 h-px w-7 bg-token-sidebar-surface-tertiary"}),r(u,g)]},f)),d?e.jsxs("button",{onClick:de.toggleGptListCollapsed,className:"flex h-10 w-full items-center gap-2 rounded-lg px-2 text-sm text-token-text-primary hover:bg-token-sidebar-surface-secondary",children:[e.jsx("div",{className:"flex h-6 w-6 flex-shrink-0 items-center justify-center",children:e.jsx(as,{className:"icon-md text-token-text-primary"})}),e.jsx("div",{className:"flex grow items-center gap-1",children:l?e.jsxs(e.Fragment,{children:[e.jsx(H,{id:"GizmoSidebarList.showLess",defaultMessage:"See less"}),e.jsx(is,{className:"icon-xs"})]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{id:"GizmoSidebarList.showMoreItems",defaultMessage:"{numMore} more",values:{numMore:m}}),e.jsx(rs,{className:"icon-xs"})]})})]}):null,e.jsx(Rs,{})]})}function Ws({currentGizmoId:s}){const{data:{gizmos:t}={}}=cs();let a=t;return ue()&&(a=t?.filter(n=>!ls(n.resource))),e.jsx(e.Fragment,{children:e.jsxs(me,{header:e.jsx("div",{className:"sticky top-[--sidebar-sticky-threshold] z-20",children:e.jsx(H,{id:"ZT2HVu",defaultMessage:"GPTs"})}),hideHeader:!0,isLastInGroup:!1,children:[e.jsx(ws,{isNewConversation:!0}),e.jsx(Us,{gizmo:a??[],currentGizmoId:s,maxToShowOnLoad:ds})]})})}function Vs({clientThreadId:s}){const t=$(),a=O(),i=B(),n=te(),{recentConversationLimit:l}=us(),[c,d]=o.useState(!1),m=o.useRef(!1),{conversations:r,data:u,isLoading:g,isError:f,refetch:x}=fe({recentConversationLimit:l}),[p,S]=o.useState(!0),h=o.useCallback(function(E){E===void 0&&S(!1),x({cancelRefetch:!0})},[x,S]),v=f||u===void 0&&!g&&m.current;u===void 0&&!g&&!m.current&&(m.current=!0,h(!0)),o.useMemo(()=>{ke.publish({kind:"refreshHistory",conversations:r})},[r]);const y=n!=null&&n.kind==="conversation"&&n.gizmoId!=null&&ms(n.gizmoId),M=o.useRef(0);return e.jsxs("div",{onDragOver:b=>{b.preventDefault(),y&&d(!0)},onDrop:b=>{b.preventDefault(),y&&(d(!1),ne(t,a,i,n.conversationId,null,n.gizmoId))},onDragEnter:b=>{b.preventDefault(),y&&(M.current+=1)},onDragLeave:b=>{b.preventDefault(),y&&(M.current-=1,M.current===0&&d(!1))},className:C(c&&"opacity-50"),children:[v&&e.jsx(fs,{showRetry:p,refetch:h}),e.jsx(Ks,{clientThreadId:s})]})}function Ks({clientThreadId:s}){const{conversations:t,buckets:a,isLoading:i,hasNextPage:n,fetchNextPage:l,isFetchingNextPage:c}=fe({buckets:!0,recentConversationLimit:1}),d=i||c,m=t.length===0,r=Ne(),u=Z(s),g=Le().activeServerThreadIds,f=r?void 0:u,x=o.useRef(null),p=o.useCallback(h=>{i||h==null||(x.current?.disconnect(),x.current=new IntersectionObserver(v=>{v[0].isIntersecting&&n&&l()},{rootMargin:"0px 0px 350px 0px",threshold:.1}),x.current.observe(h))},[i,n,l]);o.useEffect(()=>()=>{x.current?.disconnect()},[]);const S=e.jsx(Oe,{className:"justify-self-center will-change-transform"});return m?S:e.jsxs(e.Fragment,{children:[a.map(h=>e.jsx(me,{header:h.label,condensed:!0,children:h.items.map((v,N)=>e.jsx(hs,{item:v,isActiveInMainWindow:v.id===f,isActive:g.has(v.id),testId:`history-item-${N}`},v.id))},h.key)),!m&&n&&!c&&e.jsx("div",{className:"h-1","data-testid":"infinite-scroll-trigger",ref:p}),d&&S]})}const qs=U(()=>W(()=>import("./diz3gorkdm8k36uy.js"),__vite__mapDeps([5,1,6,2,3,7,8,9,10])).then(s=>s.SnorlaxSidebarList));function Qs({clientThreadId:s}){const t=P(),a=Me(s),{isUnauthenticated:i}=ee(),n=ue(),l=!1;if(i)return null;const c=n&&e.jsx(qs,{includeRevisedSidebarIa:!0,currentGizmoId:a}),d=l,m=e.jsx(Vs,{clientThreadId:s}),r=t?e.jsx(Ws,{currentGizmoId:a}):null,u=e.jsx(xs,{});return e.jsxs("div",{className:C(I.screenContent,"group/sidebar"),children:[r,null,c,d,u,m]})}function Ys(){const s=P(),t=s?.data==null,{isUnauthenticated:a}=ee(),{openSettings:i}=gs(),[n]=o.useState(()=>{const d=Ee.getCookie(Te.Workspace);return typeof d=="string"&&d!==ze}),[l,c]=o.useState(!0);return o.useEffect(()=>{c(!1)},[]),!s&&l||n&&t?null:a?e.jsx(Es,{}):e.jsx(Ms,{onClickSettings:()=>i()})}function Zs(){return e.jsx(ps,{className:C(I.screenTrailingBarContainer),children:e.jsxs(he,{name:"sidebar-footer-bar",className:"relative z-10 mb-[0.5px] grid-cols-[minmax(0,_1fr)] px-sidebar-inline pb-1.5 pt-2.5",type:"secondary",disableSizeTracking:!0,trailing:!0,style:{"--bar-gap":"6px"},children:[e.jsx(Ss,{}),e.jsx(Ts,{}),e.jsx(Ys,{})]})})}const $s=U(()=>W(()=>import("./g56z0xf7aensi5ys.js"),__vite__mapDeps([11,1,6,2,3,7,12,13,14])).then(s=>s.FannyPackIconButton));function Js({onNewThread:s}){const t=O(),a=o.useRef(null),i=X(),{useStore:n,actions:l}=V(),c=n(S=>S.isSidebarOpen),{isSidebarFlyoutOpen:d}=bs(),m=d(j.Conversation),r=d(j.Gizmo),u=d(j.Snorlax),g=c&&!m&&!r&&!u,f=se();function x(){f&&l.closeSidebar()}vs({checkElement:S=>S?.tagName==="NAV",enabled:g,onLightDismiss:x});const{isFannyPackEnabled:p}=js();return e.jsxs(e.Fragment,{children:[e.jsx(he,{type:"primary",className:C(I.screenHeader),name:"sidebar-header",children:e.jsxs("div",{className:"flex min-h-[var(--screen-thread-header-min-height,60px)] w-full flex-1 items-center justify-between px-[var(--sidebar-inline-padding)]",ref:a,children:[e.jsx("div",{className:"grid items-center gap-1",children:e.jsx(Is,{className:C(I.closeSidebarAction),style:{viewTransitionName:"var(--vt_toggle_sidebar_opened)"},onClick:()=>{l.closeSidebar()},onEnterPress:()=>{l.closeSidebar()},icon:e.jsxs(e.Fragment,{children:[e.jsx(Cs,{className:C(I.sidebarIcon,"hidden @lg/screen-composer:inline-flex")}),e.jsx(ys,{className:C(I.sidebarIcon,"@xs/screen-composer:inline-flex @lg/screen-composer:hidden")})]}),label:t.formatMessage(Xs.closeSidebar),tooltipSideOffset:4})}),e.jsxs("div",{className:"flex items-center",children:[p&&e.jsx(ks,{children:e.jsx($s,{className:I.searchAction,icon:e.jsx(Ns,{className:I.sidebarIcon}),style:{viewTransitionName:"var(--vt_search_sidebar)"}})}),!i&&e.jsx(zs,{location:"sidebar",onNewThread:s})]})]})}),e.jsx("div",{className:C(I.leadingBar,I.leadingBarScrollAnimation,"pointer-events-none absolute inset-0 h-full"),children:" "})]})}const Xs=J({closeSidebar:{id:"fM0vj3",defaultMessage:"Close Sidebar"}});function ot(){const{clientThreadId:s,onNewThread:t}=w(),[a,i]=o.useState(!1),[n,l]=o.useState(!1),[c,d]=o.useState(!1),{actions:m,useStore:r}=V(),u=r(h=>h.isSidebarOpen),g=r(h=>h.mode),f=o.useCallback(h=>h===j.Conversation?a:h===j.Gizmo?n:h===j.Snorlax?c:!1,[a,n,c]),x=o.useCallback((h,v)=>{const N=y=>{h===j.Conversation?i(y):h===j.Gizmo?l(y):h===j.Snorlax&&d(y)};v?N(!0):setTimeout(()=>{N(!1)},100)},[]),p=o.useRef(null),S=se();return Ps(()=>{x(j.Conversation,!1),x(j.Gizmo,!1),x(j.Snorlax,!1),u&&(g===ce.Floating||S)&&setTimeout(()=>{m.closeSidebar()},100)}),e.jsx(Ls,{value:{isSidebarFlyoutOpen:f,onSidebarFlyoutOpenChange:x},children:e.jsx(Os,{anchor:"vertical",className:C(I.screen,"popover sidebar flex-1 border-r border-r-token-border-xlight"),name:"sidebar",leading:e.jsx(Js,{onNewThread:t}),ref:p,trackLeading:!0,trailing:e.jsx(Zs,{}),children:e.jsx(Qs,{clientThreadId:s})})})}export{rt as C,ws as D,Us as G,ot as a,Gs as b};
//# sourceMappingURL=mwkkzpk83u6e8doo.js.map
