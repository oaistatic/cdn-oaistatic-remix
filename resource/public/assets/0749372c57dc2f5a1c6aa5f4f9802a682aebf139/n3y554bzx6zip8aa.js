import{r as x,j as e,ad as M,M as g}from"./lklglvrzltpv3f05.js";import{cj as j,h as I,M as R,d$ as C,ao as S,cw as T}from"./ltrr4mhf6s4m7a72.js";import{bI as F,b_ as E,b$ as N,c0 as w,c1 as D}from"./ntw4l0fkgqdiln85.js";import{A as v,R as $}from"./gzp99d3yjsamuheq.js";import"./bsxj1qnf5qq972mc.js";import"./kqwdyvkaaavvn8k3.js";import"./abdi060vkh3h3l2t.js";function O({turnIndex:s,clientThreadId:a}){const i=j(a,l=>T.getTurnContentReferences(l,s)),n=x.useMemo(()=>{const l=[],c=new Set;return i.forEach(t=>{t.type==="file"&&!c.has(t.id)?(l.push({id:t.id,name:t.name,cloud_doc_url:t.cloud_doc_url??t.extra?.cloud_doc_url,text:t.text}),c.add(t.id)):t.type==="file_navlist"&&t.items.forEach(r=>{c.has(r.id)||(l.push({name:r.name,cloud_doc_url:r.cloud_doc_url,text:r.description,id:r.id,lastModifiedTime:r.last_modified_time}),c.add(r.id))})}),l},[i]),d=F(a),u=E(d),f=j(a,l=>l?.conversationTurns[s]?.messages??[]),m=x.useMemo(()=>{if(!u)return[];const l=[],c=new Set;for(const t of f)if(t.message.author.role===I.Tool&&t.message.author.name==="file_search"&&t.message.content.content_type===R.TetherBrowsingDisplay){const r=N(t.message.content.result),h=t.message.metadata?.cloud_doc_urls??[];r.chunks.forEach((o,_)=>{if(!o.documentId||c.has(o.documentId))return;c.add(o.documentId);let p;o.metadata.cloud_doc_url?p=o.metadata.cloud_doc_url.toString():_<h.length?p=h[_]:o.documentId.endsWith("--google")&&(p=`https://drive.google.com/file/d/${o.documentId.split("--")[1]}`);const b=o.metadata["File last modified at"]??o.metadata["File created at"];l.push({id:o.documentId,name:o.title,cloud_doc_url:p,text:o.contents,lastModifiedTime:b?b.toString():void 0})})}return l},[u,f]);return e.jsx(M,{children:e.jsxs("div",{className:"mt-[calc(var(--threadFlyOut-leading-height,57px)*-1)] flex w-full flex-col bg-token-main-surface-primary",children:[e.jsx(y,{title:e.jsx(g,{id:"dlVlo6",defaultMessage:"Citations"}),items:n}),e.jsx(y,{title:e.jsx(g,{id:"njZblE",defaultMessage:"Search Results"}),items:m})]})})}function y({title:s,items:a,scrollToHeader:i,shouldAnimateScroll:n}){const d=x.useRef(null),u=C();return x.useEffect(()=>{d.current&&i&&(u?d.current.scrollIntoView({behavior:n?"smooth":"instant"}):setTimeout(()=>{d.current&&d.current.scrollIntoView({behavior:n?"smooth":"instant"})},300))},[i,n,u]),!a||a.length===0?null:e.jsxs("div",{ref:d,children:[e.jsx(v,{className:S("sticky top-0 z-[1] flex h-[calc(var(--screen-thread-header-min-height,60px)+1px)] items-center border-b border-token-border-sharp bg-token-main-surface-primary px-6 pt-4 font-medium text-token-text-primary",u?"pb-3.5 text-panel-title":"pb-4 text-sm"),children:s}),e.jsx("div",{className:"flex flex-col px-3 py-2",children:a.map((f,m)=>e.jsx(v,{index:m,children:e.jsx(A,{item:f},m)},`${s}-${m}`))})]})}function A({item:s}){const a=w(s.cloud_doc_url??""),i=a?.type??e.jsx(g,{id:"bqY3sN",defaultMessage:"File"}),n=a?.Icon??D;return e.jsxs("a",{href:s.cloud_doc_url,target:"_blank",rel:"noreferrer",className:"flex flex-col gap-0.5 rounded-xl px-3 py-2.5 hover:bg-token-main-surface-secondary",children:[e.jsxs("div",{className:"line-clamp-1 flex h-6 items-center gap-2 text-xs",children:[n&&e.jsx(n,{className:"icon-sm rounded-full bg-token-main-surface-primary object-cover"}),i]}),e.jsx("div",{className:"line-clamp-2 text-sm font-semibold",children:s.name}),(s.text??s.lastModifiedTime)&&e.jsxs("div",{className:"line-clamp-2 text-sm font-normal leading-snug text-token-text-secondary",children:[s.lastModifiedTime&&e.jsxs("span",{children:[e.jsx($,{date:new Date(s.lastModifiedTime)})," â€” "]}),s.text]})]})}export{O as ChatScreenRetrievalResultsFlyoutContent,y as SourcesListGroup};
//# sourceMappingURL=n3y554bzx6zip8aa.js.map
