const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/b8s8hyaj83le3elg.js","assets/ltrr4mhf6s4m7a72.js","assets/lklglvrzltpv3f05.js","assets/root-bh5spu2n.css","assets/bygcqg9ufhsq2txx.js","assets/ntw4l0fkgqdiln85.js","assets/conversation-small-iybhw0ps.css","assets/l1i7j2vbu8spc04r.js","assets/ccbvqxrwvcpykpsk.js","assets/demuoz4d7nhb3j9v.js","assets/hzqr5if7i3daaxip.js","assets/c4bxzbp1808foto4.js","assets/hp8mojjxpq08vffk.js","assets/lcjv32y33gj1btof.js","assets/j76sukxeyhhq4acx.js","assets/f3wqh5wbtzeabanv.js","assets/onrdehsmaa6zwzad.js","assets/h5nriw9v0r4o65us.js","assets/heefrlxlra66lmjs.js"])))=>i.map(i=>d[i]);
import{aq as R,gM as oe,r as w,h as D,M as K,y as le,ba as ie,bm as U,ao as ce,l as de,bA as Se,aN as ue,aO as me,aQ as ge,bP as W,f as Ce,gN as S,bc as F,gO as we,N as Ne,gP as pe}from"./ltrr4mhf6s4m7a72.js";import{j as e,r as c,c as xe,M as _e,a as fe}from"./lklglvrzltpv3f05.js";import{ga as h,ik as Q,il as X,c4 as Me,aW as ke,A as k,im as De,ie as Oe,U as Pe,e4 as Le,e5 as Ae,e6 as Y,e8 as Z,e9 as Te,h7 as Re,e7 as Ie,io as Fe,ip as Ve,iq as $e}from"./ntw4l0fkgqdiln85.js";import{S as he}from"./f3wqh5wbtzeabanv.js";import{S as $,c as be,_ as Ee,a as ee,b as z,v as Ue,d as te,g as Be,e as qe,u as We,f as ze}from"./egqiifu2w883tusr.js";import{A as ve}from"./dmls56e1re49jwsn.js";import{_ as Ge}from"./fzrn137102spawew.js";import{C as Je}from"./bygcqg9ufhsq2txx.js";import"./e9lafxuzyeh4418f.js";import"./j9pn3dpqp3dnyeg5.js";function He(){const t=h();return e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:["Force Use Search",!1]}),e.jsx($,{id:"force-use-search",options:[{label:"Default",value:"default"},{label:"Force",value:"true"},{label:"Disable",value:"false"}],name:"force-use-search",className:"mt-1 shadow-none dark:text-gray-800",value:t.forceUseSearch==null?{value:"default",label:"Default"}:t.forceUseSearch?{value:"true",label:"Force"}:{value:"false",label:"Disable"},isMulti:!1,components:{Input:Ke},onChange:n=>{h.setState({forceUseSearch:(n?.value??"default")==="default"?null:n?.value==="true"})}})]})})}const Ke=t=>e.jsx(be.Input,{...t,inputClassName:"focus:ring-0"});var Qe=["allowCreateWhileLoading","createOptionPosition","formatCreateLabel","isValidNewOption","getNewOptionData","onCreateOption","options","onChange"],ae=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,l=String(n).toLowerCase(),a=String(r.getOptionValue(o)).toLowerCase(),i=String(r.getOptionLabel(o)).toLowerCase();return a===l||i===l},G={formatCreateLabel:function(n){return'Create "'.concat(n,'"')},isValidNewOption:function(n,o,r,l){return!(!n||o.some(function(a){return ae(n,a,l)})||r.some(function(a){return ae(n,a,l)}))},getNewOptionData:function(n,o){return{label:o,value:n,__isNew__:!0}}};function Xe(t){var n=t.allowCreateWhileLoading,o=n===void 0?!1:n,r=t.createOptionPosition,l=r===void 0?"last":r,a=t.formatCreateLabel,i=a===void 0?G.formatCreateLabel:a,s=t.isValidNewOption,d=s===void 0?G.isValidNewOption:s,m=t.getNewOptionData,b=m===void 0?G.getNewOptionData:m,p=t.onCreateOption,f=t.options,u=f===void 0?[]:f,j=t.onChange,g=Ee(t,Qe),v=g.getOptionValue,x=v===void 0?Be:v,O=g.getOptionLabel,L=O===void 0?qe:O,y=g.inputValue,A=g.isLoading,P=g.isMulti,_=g.value,T=g.name,N=c.useMemo(function(){return d(y,ee(_),u,{getOptionValue:x,getOptionLabel:L})?b(y,i(y)):void 0},[i,b,L,x,y,d,u,_]),I=c.useMemo(function(){return(o||!A)&&N?l==="first"?[N].concat(z(u)):[].concat(z(u),[N]):u},[o,l,A,N,u]),M=c.useCallback(function(C,B){if(B.action!=="select-option")return j(C,B);var H=Array.isArray(C)?C:[C];if(H[H.length-1]===N){if(p)p(y);else{var q=b(y,y),ye={action:"create-option",name:T,option:q};j(Ue(P,[].concat(z(ee(_)),[q]),q),ye)}return}j(C,B)},[b,y,P,T,N,p,j,_]);return te(te({},g),{},{options:I,onChange:M})}var Ye=c.forwardRef(function(t,n){var o=We(t),r=Xe(o);return c.createElement(ze,Ge({ref:n},r))}),Ze=Ye;function et({children:t,sidebarOpen:n,onClose:o}){return e.jsx(Q.Root,{show:n,as:c.Fragment,children:e.jsxs(X,{as:"div",className:"relative z-10",onClose:o,children:[e.jsx("div",{className:"fixed inset-0"}),e.jsx("div",{className:"fixed inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx("div",{className:"pointer-events-none fixed inset-y-0 right-0 flex max-w-full pl-10",children:e.jsx(Q.Child,{as:c.Fragment,enter:"transform transition ease-in-out duration-100 sm:duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in-out duration-300 sm:duration-500",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsx(X.Panel,{className:"pointer-events-auto w-screen max-w-md border-l border-gray-100 dark:border-gray-700",children:e.jsx("div",{className:"h-full overflow-y-auto bg-token-main-surface-primary shadow-xl",children:t})})})})})})]})})}function tt({clientThreadId:t}){const{rebaseSystemMessageContent:n,showDebugConversationTurns:o}=h(),[r,l]=c.useState(()=>n?JSON.stringify(n,null,2):void 0),[a,i]=c.useState(!!n),s=oe(t,w.getThreadCurrentLeafId(t)).filter(u=>u.message.author.role!==D.Root).map(u=>u.message),m=Me(s,u=>u.content.content_type===K.SystemContent)?.content??null,b=()=>{l(m?JSON.stringify(m,null,2):"")},p=le(),f=c.useMemo(()=>ke(u=>{try{u?h.setState({rebaseSystemMessageContent:{...JSON.parse(u),content_type:K.SystemContent}}):h.setState({rebaseSystemMessageContent:null}),p.closeAll()}catch{p.danger("The System Message is not valid JSON")}},500),[p]);return c.useEffect(()=>{a?f(r):(f.cancel(),h.setState({rebaseSystemMessageContent:null}))},[f,a,r]),e.jsxs("div",{className:"flex flex-col gap-3 px-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(ie,{label:"Enable to apply this system message to the current conversation.",children:e.jsx(k,{id:"enabled",label:"Enabled",checked:a,onChange:u=>i(u.currentTarget.checked)})}),e.jsx(k,{id:"show-internal-conversation-turns",label:"Conversation debug mode",checked:o,onChange:()=>{h.setState({showDebugConversationTurns:!o})}})]}),e.jsx(U,{disabled:!m,className:"mt-2",onClick:b,size:"small",children:"Load active system message"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:"System Message"}),e.jsx(at,{disabled:!a,placeholder:m?"Press `Load active system message` to pre-populate this":"Start a conversation and then press `Load active system message` to pre-populate this",className:"min-h-[75vh] rounded-md border border-gray-400 p-1 font-mono",value:r,onChange:u=>l(u.target.value)})]})]})}const at=R.textarea`w-full rounded-lg border border-token-border-light bg-token-main-surface-primary text-sm text-token-text-primary focus:border-token-text-primary focus:shadow-none focus:outline-none focus:ring-token-text-primary disabled:bg-token-main-surface-tertiary`;function st({clientThreadId:t}){const[n,o]=c.useState([]),r=w.getThreadCurrentLeafId(t),l=w.getThreadConversationTurns(t,r),a=s=>{const m=w.getTree(t).getLeafFromNode(s);w.setThreadCurrentLeafId(t,m.id)},i=s=>{o(d=>[...d,r]),a(s)};return e.jsxs(e.Fragment,{children:[n.length>0&&e.jsxs(U,{className:"absolute left-2 top-2",color:"secondary",onClick:()=>{const s=n[n.length-1];a(s),o(d=>d.slice(0,-1))},children:[e.jsx(De,{className:"icon-sm"}),"Go back to ",n[n.length-1]]}),e.jsx("div",{className:"flex flex-col items-center gap-4 overflow-auto p-4 text-xs",children:l.map((s,d)=>{const m=s.messages[0].nodeId,b=w.getTree(t),p=d!==0?b.getParent(m):null,f=p!=null?p.children.findIndex(x=>m===x):0,u=p!=null?p.children:[],j=u.slice(0,f),g=u.slice(f+1);let v;switch(s.role){case D.User:v="bg-blue-500";break;case D.Assistant:v="bg-gray-600";break;default:v="bg-gray-400";break}return e.jsxs("div",{className:ce("relative p-2",v),children:[e.jsx("div",{className:"absolute bottom-0 left-0 -ml-2 flex -translate-x-full gap-2 pl-2",children:j.map(x=>e.jsx(se,{variantId:x,onChangeItemInView:i},x))}),e.jsx("div",{className:"absolute left-full top-0 ml-2 flex gap-2 pr-2",children:g.map(x=>e.jsx(se,{variantId:x,onChangeItemInView:i},x))}),e.jsx("div",{className:"flex flex-col gap-2",children:s.messages.map(x=>e.jsxs("div",{className:"h-14 w-32 truncate bg-gray-200 p-1 text-black",children:[e.jsx("div",{className:"font-semibold",children:x.nodeId}),e.jsx("div",{className:"italic text-token-text-tertiary",children:x.message.author.role}),e.jsx("div",{children:de(x.message)})]},x.nodeId))})]},d)})})]})}function se({variantId:t,onChangeItemInView:n}){return e.jsx("button",{className:"w-32 truncate bg-gray-400 p-2 text-black opacity-50 hover:opacity-100",onClick:()=>{n(t)},children:e.jsx("span",{className:"bg-gray-200 p-2",children:t})},t)}const nt=ue(()=>me(()=>import("./b8s8hyaj83le3elg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16])).then(t=>t.DebugModalContents)),rt=ue(()=>me(()=>import("./h5nriw9v0r4o65us.js"),__vite__mapDeps([17,2,1,3,18,5,6])).then(t=>t.FramesViewer)),ne=Object.values(Oe);function Mt(){return e.jsx("button",{"data-testid":"open-debug-sidebar-button",className:"flex h-6 w-6 items-center justify-center rounded-full border border-token-border-light text-xs text-token-text-secondary",onClick:()=>{Pe.setActiveSidebar("debug")},children:e.jsx(he,{className:"icon-xs"})})}function ot({children:t,title:n,icon:o,isOpen:r,slideOver:l,onClose:a}){const i=e.jsxs(pt,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 text-lg font-semibold text-gray-900 dark:text-white",children:[e.jsx(o,{className:"icon-sm"}),n]}),e.jsx("div",{className:"mr-2 mt-2 flex h-7 items-center",children:e.jsx(Se,{onClick:a})})]}),t]});return l?e.jsx(et,{sidebarOpen:r,onClose:a,children:i}):r?i:null}function lt({nodes:t,setDebugNodeIndex:n,setFrameSrc:o,conversationId:r}){const l=t.map((a,i)=>{const s=a.message,{role:d,name:m}=s.author,b=m&&m!==d,p=S(s,"metadata.__internal.model_id"),f=S(s,"metadata.__internal.agent.settings.completion_api.engine"),u=S(s,"metadata.__internal.model_experiment_name"),j=S(s,"metadata.__internal.model_experiment_treatment"),g=S(s,"metadata.__internal.alternative_model_selection_rule"),v=S(s,"metadata.__internal.model_experiment_group_name"),x=S(s,"metadata.__internal.model_experiment_group_params"),O=S(s,"metadata.__internal.model_experiment_override"),L=S(s,"metadata.__internal.model_experiment_eval_seq"),y=S(s,"metadata.__internal.raw_tokens")?.length,A=S(s,"metadata.request_id"),P=S(s,"metadata.__internal.search_settings"),_=F.getAudio(s),T=F.getAudioAssetPointers(s),N=F.getFrameAssetPointers(s),I=F.getVideoContainerAssetPointers(s);return e.jsxs(ft,{role:"button",onClick:()=>n(i),children:[e.jsxs("div",{className:ce("flex items-center gap-1 break-words text-xs font-semibold uppercase",d===D.User?"text-token-text-primary":"text-token-text-tertiary"),children:[d===D.User&&e.jsx(Fe,{className:"icon-sm"}),d,b&&` (${m})`,s.recipient&&" -> ",we(s)]}),(s.author.role!==D.System||A)&&e.jsxs("div",{className:"text-xs text-token-text-tertiary",children:[e.jsxs("div",{children:["ID: ",s.id]}),a.id!==s.id&&e.jsxs("div",{children:["UI Node ID: ",a.id]}),e.jsxs("div",{children:["Req ID: ",A||"Reload page to see ID"]})]}),e.jsx("div",{className:"line-clamp-6",children:de(s)}),(y||p||f||u||j||g||v||x||O||L||P)&&e.jsxs("div",{className:"mt-4 w-full self-start rounded-xl bg-blue-200 px-3 py-0.5 text-xs text-black",children:[y!==void 0&&e.jsxs("div",{children:[e.jsx("b",{children:"Tokens Count:"})," ",y]}),p&&e.jsxs("div",{children:[e.jsx("b",{children:"Model ID:"})," ",p]}),f&&e.jsxs("div",{children:[e.jsx("b",{children:"Engine:"})," ",f]}),u&&e.jsxs("div",{children:[e.jsx("b",{children:"Experiment:"})," ",u]}),j&&e.jsxs("div",{children:[e.jsx("b",{children:"Treatment:"})," ",j]}),g&&e.jsxs("div",{children:[e.jsx("b",{children:"Alternative Model Rule:"})," ",g]}),v&&e.jsxs("div",{children:[e.jsx("b",{children:"Group Name:"})," ",v]}),x&&e.jsxs("div",{children:[e.jsx("b",{children:"Group Params:"}),e.jsx("div",{children:JSON.stringify(x,null,2)})]}),O&&e.jsxs("div",{children:[e.jsx("b",{children:"Above Params are Overridden By:"})," ",O]}),L&&e.jsxs("div",{children:[e.jsx("b",{children:"Experiment Eval Seq:"})," click to see"]}),P&&e.jsxs("div",{children:[e.jsx("b",{children:"Search Settings:"}),e.jsx("div",{children:JSON.stringify(P,null,2)})]})]}),_.length||T.length||I.length?e.jsxs("div",{className:"mt-4 flex flex-col flex-nowrap gap-2",children:[e.jsx(mt,{frameAssets:N,setFrameSrc:o},i),_.map((M,C)=>e.jsx(E,{audio:M,conversationId:r},`audio-asset-${C}`)),T.map((M,C)=>e.jsx(E,{assetPointer:M,conversationId:r},`audio-${C}`)),I.map((M,C)=>e.jsx(gt,{assetPointer:M,conversationId:r},`video-asset-${C}`))]}):null]},s.id)});return e.jsx(xt,{children:l})}const V=t=>e.jsx(be.Input,{...t,inputClassName:"focus:ring-0"});function it(){const t=h(),o=Ve().map(a=>({label:a.name,options:a.options.flatMap(i=>"options"in i?i.options.map(s=>({label:s.value,value:s.value})):[{label:`${i.value} (${i.name})`,value:i.value}])})),[r,l]=c.useState(ne[0]);return e.jsxs("div",{className:"mt-2 flex flex-col justify-around gap-3 px-4 py-1 text-xs font-semibold",children:[e.jsx(k,{id:"force-paragen",label:"Force Parallel Gen",checked:t.forceParagen,onChange:()=>{h.setState({forceParagen:!t.forceParagen})}}),e.jsx(Ze,{options:o,name:"force-paragen-model",className:"shadow-none dark:text-gray-800",isDisabled:!t.forceParagen,isLoading:o.length===0,value:t.forceParagenModel,isClearable:!0,isMulti:!1,components:{Input:V},onChange:a=>{h.setState({forceParagenModel:a??$e})}}),t.forceParagen?e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Paragen Stream Type:"}),e.jsx($,{options:[{label:"Do Not Override",value:"none"},{label:"Force Classic Stream Behavior",value:"default"},{label:"Wait for Assistant",value:"wait_for_assistant"},{label:"Interleave",value:"interleave"}],name:"paragen-stream-type",className:"shadow-none dark:text-gray-800",value:t.paragenStreamType==="none"?{value:"none",label:"Do Not Override"}:t.paragenStreamType==="default"?{value:"default",label:"Force Classic Stream Behavior"}:t.paragenStreamType==="wait_for_assistant"?{value:"wait_for_assistant",label:"Wait for Assistant"}:{value:"interleave",label:"Interleave"},isMulti:!1,components:{Input:V},onChange:a=>{h.setState({paragenStreamType:a?.value??"none"})}})]}):null,t.forceParagen?e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Show CoT in Paragen:"}),e.jsx($,{options:[{label:"Allow",value:"allow"},{label:"Hide CoT for Alter Model",value:"hide_alter"},{label:"Hide",value:"hide"}],name:"paragen-stream-type",className:"shadow-none dark:text-gray-800",value:t.paragenCotSummaryDisplay==="allow"?{value:"allow",label:"Allow"}:t.paragenCotSummaryDisplay==="hide_alter"?{value:"hide_alter",label:"Hide CoT for Alter Model"}:{value:"hide",label:"Hide"},isMulti:!1,components:{Input:V},onChange:a=>{h.setState({paragenCotSummaryDisplay:a?.value??"allow"})}})]}):null,e.jsx(k,{id:"show-paragen-metadata",label:"Show Paragen Metadata",checked:t.showParagenMetadata,onChange:()=>{h.setState({showParagenMetadata:!t.showParagenMetadata})}}),e.jsx(He,{}),e.jsx(k,{id:"force-rate-limit",label:"Force Rate Limit",checked:t.forceRateLimit,onChange:()=>{h.setState({forceRateLimit:!t.forceRateLimit})}}),e.jsx(k,{id:"reset-rate-limit",label:"Reset Rate Limits",checked:t.resetRateLimits,onChange:()=>{h.setState({resetRateLimits:!t.resetRateLimits})}}),e.jsx(ie,{label:"Enabling this will show debug conversation messages in the chat",children:e.jsx(k,{id:"show-internal-conversation-turns",label:"Conversation debug mode",checked:t.showDebugConversationTurns,onChange:()=>{h.setState({showDebugConversationTurns:!t.showDebugConversationTurns})}})}),e.jsx("hr",{}),e.jsx("div",{children:"Reset announcement:"}),e.jsx($,{options:ne.map(a=>({label:a.replace("oai/apps/",""),value:a})),name:"reset-announcement",className:"break-all font-mono shadow-none dark:text-gray-800",value:{label:r,value:r},isMulti:!1,components:{Input:V},onChange:a=>{a?.value&&l(a?.value)}}),e.jsx(U,{onClick:()=>Ne.resetAnnouncement(r),children:"Reset"})]})}const re=R.div`px-3 pb-2 text-xs font-semibold uppercase border-b-2 ${({$isSelected:t})=>t?"border-black dark:border-white":"border-transparent"}`;function kt({clientThreadId:t,isOpen:n,slideOver:o,onClose:r}){const l=xe(),a=ge(),[i,s]=c.useState("conversation");return a?.includes("debug")?e.jsx(ot,{icon:he,title:l.formatMessage(J.debugTitle),isOpen:n,slideOver:o,onClose:r,children:e.jsxs(Le,{orientation:"vertical",defaultValue:i,onValueChange:d=>s(d),children:[e.jsxs(Ae,{className:"mb-4 flex items-center justify-center gap-2 px-2 py-1 text-xs",children:[e.jsx(Y,{value:"conversation",children:e.jsx(re,{$isSelected:i==="conversation",children:"Conversation"})}),e.jsx(Y,{value:"system-message-editor",children:e.jsx(re,{$isSelected:i==="system-message-editor",children:"System Message"})}),!1]}),e.jsx(Z,{value:"conversation",children:e.jsx(ct,{clientThreadId:t})}),e.jsx(Z,{value:"system-message-editor",children:e.jsx(tt,{clientThreadId:t})}),!1]})}):null}function ct({clientThreadId:t}){const n=xe(),o=w.getThreadCurrentLeafId(t),r=oe(t,o).filter(g=>g.message.author.role!==D.Root),[l,a]=c.useState(),i=ge(),s=c.useCallback(()=>{a(void 0)},[]),d=le(),m=c.useCallback(g=>{const v=w.getTree(t);Te(v.getTextFromThread(o),d,g)},[o,t,d]),[b,p]=c.useState(!1),[f,u]=c.useState(void 0);return i?.includes("debug")?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-2 flex items-center justify-around px-4 py-1 text-xs font-semibold uppercase",children:e.jsx(ut,{clientThreadId:t,messages:r.map(g=>g.message)})}),!1,e.jsxs("div",{className:"flex items-center justify-around gap-2 px-4 py-1 text-xs font-semibold uppercase",children:[e.jsx("div",{children:e.jsx(Je,{onCopy:m,buttonText:n.formatMessage(J.copyText)})}),e.jsxs("button",{className:"flex items-center justify-center gap-2",onClick:()=>p(!0),children:[e.jsx(Re,{className:"icon-sm rotate-90"}),"View tree"]})]}),e.jsx(it,{}),e.jsx(lt,{nodes:r,setDebugNodeIndex:a,setFrameSrc:u,conversationId:w.getServerThreadId(t)}),l!==void 0&&e.jsx(W,{type:"success",size:"fullscreen",noPadding:!0,isOpen:!0,onClose:s,children:e.jsx(nt,{threadId:r[l].message.metadata?.__internal?.sonic_thread_id,threadUserId:r[l].message.metadata?.__internal?.sonic_user_id,onClose:s,message:r[l].message})},`DebugMessageModal-${l}`),b&&e.jsx(W,{isOpen:!0,onClose:()=>p(!1),type:"success",size:"custom",noPadding:!0,children:e.jsx(st,{clientThreadId:t})},"DebugTreeViewer"),f&&e.jsx(W,{size:"normal",isOpen:!0,onClose:()=>u(void 0),type:"success",children:e.jsx("img",{src:f,alt:"debug image"})},"DebugFrameViewer")]}):null}function dt(t,n){const o=JSON.stringify({conversation_id:w.getServerThreadId(t),messages:n},null,2),r=new Blob([o],{type:"application/json"}),l=URL.createObjectURL(r),a=document.createElement("a");a.href=l,a.download=`messages-${w.getServerThreadId(t)}.json`,a.click(),URL.revokeObjectURL(l)}function ut({clientThreadId:t,messages:n}){const o=c.useCallback(()=>{dt(t,n)},[t,n]);return e.jsx(U,{onClick:o,color:"primary",size:"small",icon:Ie,children:e.jsx(_e,{...J.downloadRawConversation})})}function mt(t){const[n,o]=c.useState([]),r=fe(),{frameAssets:l}=t;return c.useEffect(()=>{async function a(){const i=l.map(async({image_asset_pointer:s,timestamp:d})=>{const m={asset:s};return{src:(await ve.fetch(r,m)).url,timestamp:d}});return Promise.all(i)}l.length>0&&a().then(o)},[l,r]),e.jsx(rt,{frames:n,setFrameSrc:t.setFrameSrc})}function E(t){const n=je(t.assetPointer,t.conversationId),o=E.useAudioSource(t.audio),r=n??o,a=pe("3230069703").config.value.expirySeconds,[i,s]=c.useState(Date.now()),d=c.useRef(null);return c.useEffect(()=>{const m=setInterval(()=>{d.current&&d.current.currentTime>0&&!d.current.paused&&!d.current.ended&&d.current.readyState>2||s(Date.now())},a*1e3);return()=>clearInterval(m)},[a]),r?e.jsx("audio",{ref:d,controls:!0,src:r,className:"w-full"},i):null}function je(t,n){const[o,r]=c.useState(null),l=fe();return c.useEffect(()=>{t&&ve.fetch(l,{asset:t,conversationId:n}).then(a=>{r(a.url)})},[l,t,n]),o}E.useAudioSource=t=>{const[n,o]=c.useState(null);return c.useEffect(()=>{if(t){const r=atob(t.payload),l=new Uint8Array(r.length);for(let s=0;s<r.length;s++)l[s]=r.charCodeAt(s);const a=new Blob([l],{type:`audio/${t.format}`}),i=URL.createObjectURL(a);return o(i),()=>{URL.revokeObjectURL(i)}}},[t]),n};function gt(t){const n=je(t.assetPointer,t.conversationId),r=pe("3230069703").config.value.expirySeconds,[l,a]=c.useState(Date.now()),i=c.useRef(null);return c.useEffect(()=>{const s=setInterval(()=>{i.current&&i.current.currentTime>0&&!i.current.paused&&!i.current.ended&&i.current.readyState>2||a(Date.now())},r*1e3);return()=>clearInterval(s)},[r]),n?e.jsx("video",{ref:i,controls:!0,src:n,className:"w-full"},l):null}const pt=R.div`overflow-y-auto h-full md:w-[250px] lg:w-[300px] xl:w-[350px] 2xl:w-[400px] md:border-l md:border-gray-100 md:dark:border-gray-700 popover bg-token-main-surface-primary`,xt=R.pre`whitespace-pre-wrap text-sm`,ft=R.div`px-6 py-4 flex flex-col gap-1 hover:bg-gray-50 dark:hover:bg-gray-500/10 cursor-pointer border-b dark:border-white/10 border-gray-200`,J=Ce({debugTitle:{id:"DebugSidebar.debugTitle",defaultMessage:"Debug"},copyText:{id:"DebugSidebar.copyText",defaultMessage:"Copy text"},downloadRawConversation:{id:"DebugSidebar.downloadRawConversation",defaultMessage:"Download raw conversation"},uploadRawConversation:{id:"DebugSidebar.uploadRawConversation",defaultMessage:"Upload conversation dump"},closeSidebar:{id:"DebugSidebar.closeSidebar",defaultMessage:"Close sidebar"}});export{ct as DebugConversation,kt as DebugConversationSidebar,Mt as OpenDebugSidebarButton,ot as default};
//# sourceMappingURL=j2h13udkl1zlckh2.js.map
